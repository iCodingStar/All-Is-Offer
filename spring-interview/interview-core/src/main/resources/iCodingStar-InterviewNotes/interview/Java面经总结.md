# Java核心问题

## 锁
* 应用：用锁来保证原子性

### 原子性与原子操作
[原子操作和竞争](http://www.infoq.com/cn/articles/atomic-operations-and-contention)
* 概念：计算机最重要的构成单位是原子操作。原子操作是一种不可细分的操作，或者在系统中的其他处理器看来是不可再分了。
* 例子：(counter ++)两个处理器对同一个变量进行读取，写入操作。最终计数器只被加了一次。其中一个运算丢失了。
* 作用：原子操作可以防止上面的问题，原子操作让多条指令像执行一条指令一样，在其进行运算的时候，其他的CPU无法插手。
* 实现方式：
    * 加锁：在任何时候，只有一个处理器被允许执行一个原子操作，这个处理器在操作前必须先获得锁，操作完之后释放它。这就是x86的
    Lock前缀的作用。加锁会锁住数据总线，非常缓慢，x86试图通过缓存行机制来代替加锁协议。
    * 缓存行：在使用MESI协议及其衍生协议的系统总，为了确保缓存行操作具有原子性，只需要做到以下事情：
        * 保证在正确的地方摆放内存屏障，使内存周边的操作保证正确的顺序；
        * 在读任何东西前先获得缓存行的所有权；
        * 只有当我们在整个原子操作期间一直握有独占权，才可以把结果回写了；
#### CAS实现原子操作
>JVM中的CAS操作正是利用了处理器提供的CMPXCHG指令实现的。自旋CAS实现的基本思路就是循环进行CAS操作直到成功为止。
```java

```

### 可重入锁与不可重如锁



## ReentrantLock与synchronized的区别

